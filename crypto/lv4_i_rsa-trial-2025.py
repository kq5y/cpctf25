# 最後のヒントまで開けた

from gmpy2 import iroot, next_prime
from Crypto.Util.number import long_to_bytes

e = 65537
n = 1357245723294052716257877257901199518266239008021924301790283006452471598241465749556043612206478396981618976551713454223057682247635427438547093694687726892951058765350980353226074277990048564755953339476744020240712994497717647924117842133472667977530323871003741866172869316862081335064740939874797260514722071330372630585080213636424347080860345977829241081727723351067017737469756999533504162360664714650833171685112113127640637963549165406088921829989264559
c = 103843597041414788340132892667707162979663163265149390426523016277718861673130429159405119746318792071129890003579719619736310412729562398067589359157705059926346512836289585024330023672634385591660196964740207577542464824274258890987896277370624660044772180543542430613248812555839424920737364280969067323676505004202168772159107962604797921827493997251089525811150931408432466784778478523830148488891471247377638759327658433887775956802218800199651012815418571
hint = 7128908244505976193627354601758360201627461689774840269135119226922125664097615039958692323296983320062864027033653778113274217639443055806624666486752090624636489307290431091298945951077316336770059544136051487001772394754326669026839972092003271286351255117009275847600168269630336079406631557620541097545087939985891487419289374025704048313158215725474607413587801066151604591869428508320381160482525724417087920461276521616616808065739489261919271370707220697

p_plus_q_approx, _ = iroot((3 * n + hint) // 2, 3)
r = next_prime(p_plus_q_approx)
p_cross_q = n // r

p_plus_q_start = p_plus_q_approx - 1000
while p_plus_q_start < p_plus_q_approx + 1000:
    p_plus_q = p_plus_q_start
    D, exact = iroot(p_plus_q**2 - 4 * p_cross_q, 2)
    if exact:
        p = (p_plus_q + D) // 2
        q = (p_plus_q - D) // 2
        if p * q == p_cross_q:
            break
    p_plus_q_start += 1

phi = (p - 1) * (q - 1) * (r - 1)
d = pow(e, -1, phi)

m = pow(c, d, n)
print(long_to_bytes(m).decode())
